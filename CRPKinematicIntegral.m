clear, clc

q = [0.4 0.2 -0.1];

for t=0:0.01:60
    w = [sin(0.1*t); 0.01; cos(0.1*t)]*deg2rad(3);
    a = (1/2)*[1+q(1)^2 (q(1)*q(2))-q(3) (q(1)*q(3))+q(2); ...
               (q(2)*q(1))+q(3) 1+q(2)^2 (q(2)*q(3))-q(1); ...
               (q(3)*q(1))-q(2) (q(3)*q(2))+q(1) 1+q(3)^2];
    rates = a*w;
    q(1) = q(1) + rates(1)*0.01;
    q(2) = q(2) + rates(2)*0.01;
    q(3) = q(3) + rates(3)*0.01;
    
    if t==42
        norm = sqrt(q(1)^2+q(2)^2+q(3)^2);
        disp(norm);
    end
end